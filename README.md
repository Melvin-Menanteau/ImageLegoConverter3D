# Image to Lego converter

This project converts an image into a 3D Lego representation using Three.js. First, the image is pixelated and each resulting pixel's color is defined by the average color of the corresponding area in the original image. Then, the pixelated image is converted into Lego tiles, which are displayed in a Three.js scene.

It is possible to change the pixelation level, which affects the number of Lego tiles used in the final representation. The project also includes a basic user interface for interaction.

## Features

- Pixelate an image
- Convert pixelated image to Lego tiles
- Display the resulting geometry in a Three.js scene

## Requirements

- [Node.js](https://nodejs.org/) (for development)
- [npm](https://www.npmjs.com/) (for package management)

## Libraries Used

- [Three.js](https://threejs.org/) for 3D rendering
- [npx](https://www.npmjs.com/package/npx) for running the development server
- [Vite](https://vitejs.dev/) for fast development and build tooling

## Run the Project

1. Clone the repository: ```git clone https://github.com/Melvin-Menanteau/ImageLegoConverter3D.git```
2. Navigate to the project directory: ```cd ImageLegoConverter3D```
3. Install the dependencies: ```npm install```
4. Start the development server: ```npx vite```

## Example

### Input picture[^artist]

![Input Image](./documentation/resources/images/1.png)

### Resulting Lego representation

![Lego Representation](./documentation/resources/images/pixelated_image_1.png)

----

![Lego Representation perspective view](./documentation/resources/images/pixelated_image_1_pespective.png)

### Resulting Lego representation using a different pixelation level

![Lego Representation with Different Pixelation](./documentation/resources/images/pixelated_image_2.png)

## Roadmap

### Essential Features

- [X] Interface to define the pixelation level
- [ ] Use only Lego official round tile colors
- [X] Add a button to upload an image
- [ ] Add a button to download the resulting image

### Nice-to-Have Features

- [ ] Create a frame around the resulting image (made of bricks)
- [ ] Check if the result fits in one of the Lego standard baseplates
- [ ] Cost estimation
- [ ] Use CIELAB color space for better color matching
- [ ] Lerp the camera position to the target position for a smoother transition
- [ ] Tile height adjustment based on the pixelation level

## Official Colors
The project uses a predefined set of official Lego round tile colors. The colors are defined in the json "database" (`database/colors.json`) file. If you want to use only official colors, you can toggle this feature in the user interface.

### Script to generate the official colors list
The list of official colors has been generated using [Rebrickable API](https://rebrickable.com/api/v3/docs/).

```javascript
const AUTHORIZATION_KEY = 'key <your_api_key_here>';

/* 98138 is the part number for round 1x1 tile */
const round_tile_res = await fetch('https://rebrickable.com/api/v3/lego/parts/98138/colors/', {
    method: 'GET',
    headers: {
        'Accept': 'application/json',
        'Authorization': AUTHORIZATION_KEY
    }
})

const round_tile_data = await round_tile_res.json();
const data = [];

for ({color_id} of round_tile_data.results) {
    const color_res = await fetch(
        `https://rebrickable.com/api/v3/lego/colors/${color_id}/`,
        {
            method: 'GET',
            headers: {
                'Accept': 'application/json',
                'Authorization': AUTHORIZATION_KEY
            }
        }
    );

    const color_data = await color_res.json();

    data.push({
        id: color_data.id,
        name: color_data.name,
        hex: color_data.rgb
    });
}

/* Might have some undefined colors due to API limitations */
console.log(data);
```

[^artist]:
    The image used in the examples has been generated by [BasicAppleGuy](https://basicappleguy.com/basicappleblog/bigstarrysur)